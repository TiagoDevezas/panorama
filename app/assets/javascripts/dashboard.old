$(document).ready(function() {
	// renderBarChart();
	// renderPieChart();

	// function renderBarChart() {
	// 	// Get the JSON data
	// 	$.getJSON("/api/sources", function(data) {
	// 		var data = data;
	// 		var labels = [];
	// 		var totalItems = [];
	// 		var twitterShares = [];
	// 		var facebookShares = [];
	// 		for (var i = 0; i < data.length; i++) {
	// 			labels.push(data[i].name);
	// 			totalItems.push(data[i].total_items);
	// 			twitterShares.push(data[i].twitter_shares);
	// 			facebookShares.push(data[i].facebook_shares);
	// 		}
	// 		// Draw the bar chart
	// 		drawBarChart(labels, totalItems, twitterShares, facebookShares);
	// 	});
	// 	function drawBarChart(labels, totalItems, twitterShares, facebookShares) {
	// 		var data = {
	// 			labels: labels,
	// 			datasets:[
	// 	        {
	//             label: "Artigos publicados",
	//             fillColor: "rgba(220,220,220,0.5)",
	//             strokeColor: "rgba(220,220,220,0.8)",
	//             highlightFill: "rgba(220,220,220,0.75)",
	//             highlightStroke: "rgba(220,220,220,1)",
	//             // pointColor: "rgba(220,220,220,1)",
	//             // pointStrokeColor: "#fff",
	//             // pointHighlightFill: "#fff",
	//             // pointHighlightStroke: "rgba(220,220,220,1)",
	//             data: totalItems
	// 	        },
	// 	        {
	//             label: "Partilhas no Twitter",
	//             fillColor: "rgba(151,187,205,0.5)",
	//             strokeColor: "rgba(151,187,205,0.8)",
	//             highlightFill: "rgba(151,187,205,0.75)",
	//             highlightStroke: "rgba(151,187,205,1)",
	//             // pointColor: "rgba(151,187,205,1)",
	//             // pointStrokeColor: "#fff",
	//             // pointHighlightFill: "#fff",
	//             // pointHighlightStroke: "rgba(151,187,205,1)",
	//             data: twitterShares
	// 	        },
	// 	        {
	//             label: "Partilhas no Facebook",
	//             fillColor: "rgba(151,200,205,0.5)",
	//             strokeColor: "rgba(151,200,205,0.8)",
	//             highlightFill: "rgba(151,200,205,0.75)",
	//             highlightStroke: "rgba(151,200,205,1)",
	//             // pointColor: "rgba(151,187,205,1)",
	//             // pointStrokeColor: "#fff",
	//             // pointHighlightFill: "#fff",
	//             // pointHighlightStroke: "rgba(151,187,205,1)",
	//             data: facebookShares
	// 	        }
	//         ]
	// 		};

	// 		var ctx = $("#chart").get(0).getContext("2d");

	// 		var barChart = new Chart(ctx).Bar(data, {
	// 			responsive: true,
	// 			bezierCurve: false,
	//       legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].fillColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>"
	// 		});
	// 		$("#legend").html(barChart.generateLegend());

	// 		$('canvas#chart').click(function(evt) {
	//     	var activeBars = barChart.getBarsAtEvent(evt);
	//     	pieChart = renderPieChart();
	// 			pieChart.datasets[randomNum(0,1)].points[randomNum(0, 6)].value = randomNum(50, 175);
	// 			pieChart.update();
	// 		});
	// 	}
	// }

	// function renderPieChart() {
	// 	var data = {
 //    labels: ["Eating", "Drinking", "Sleeping", "Designing", "Coding", "Cycling", "Running"],
 //    datasets: [
 //        {
 //            label: "My First dataset",
 //            fillColor: "rgba(220,220,220,0.2)",
 //            strokeColor: "rgba(220,220,220,1)",
 //            pointColor: "rgba(220,220,220,1)",
 //            pointStrokeColor: "#fff",
 //            pointHighlightFill: "#fff",
 //            pointHighlightStroke: "rgba(220,220,220,1)",
 //            data: [65, 59, 90, 81, 56, 55, 40]
 //        },
 //        {
 //            label: "My Second dataset",
 //            fillColor: "rgba(151,187,205,0.2)",
 //            strokeColor: "rgba(151,187,205,1)",
 //            pointColor: "rgba(151,187,205,1)",
 //            pointStrokeColor: "#fff",
 //            pointHighlightFill: "#fff",
 //            pointHighlightStroke: "rgba(151,187,205,1)",
 //            data: [28, 48, 40, 19, 96, 27, 100]
 //        }
	//     ]
	// 	};

	// 	var ctx = $("#radar").get(0).getContext("2d");

	// 	var radarChart = new Chart(ctx).Radar(data, {
	// 		responsive: true
	// 	});

	// 	return radarChart;
	// }
		

	// 	function randomNum(min, max) {
	// 		return Math.round(Math.random() * (max - min) + min);
	// 	}

	drawTotalsChart();

	function drawTotalsChart() {
		$.getJSON("api/totals?since=2014-10-20", function(data) {
			var data = data;
			var myChart = timeSeriesChart()
										.x(function(d) { return formatDate.parse(d['time']); })
										.y(function(d) { return +d['articles']; });


			var myChart2 = barChart()
										.x(function(d) { return formatDate.parse(d['time']); })
										.y(function(d) { return +d['total_shares']; });

			var formatDate = d3.time.format('%Y-%m-%d');

			d3.select('.bar-chart')
				.datum(data)
				.call(myChart);


			d3.select('.bar-chart2')
				.datum(data)
				.call(myChart2);

		});		
	}

});